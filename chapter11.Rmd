---
title: "Chapter 11"
output: html_notebook
---

# 11.1
```{r}
library(tidyverse)
```

# 11.2 Getting Started
```{r}
# Read a supplied file
heights <- read_csv("data/heights.csv")

# Create an inline csv
read_csv(
  "a,b,c
   1,2,3
   4,5,6")

# Ignore metadata
read_csv(
  "metadata line 1
   metadata line 2
   x,y,z
   1,2,3", skip = 2
)

# Ignore comments
read_csv(
  "# comment we should ignore
   x,y,z
   1,2,3", comment = "#"
)

# File has no column names
read_csv(
  "1,2,3
   4,5,6", col_names = FALSE
)

# Want to supply your own column names
read_csv(
  "1,2,3
   4,5,6", col_names = c("x", "y", "z")
)

# If missing values are specified in the file
read_csv(
  "a,b,c
   1,2,.", na = "."
)
```

# 11.2.2 Exercises
```{r}
# 4
# How would you read this?
strn <- "x,y\n1,'a,b'"
read_csv(strn, quote = "'")

# 5
read_csv("a,b\n1,2,3\n4,5,6")
read_csv("a,b,c\n1,2\n1,2,3,4")
read_csv("a,b\n\"1")
read_csv("a;b\n1;3")
```

# 11.3 Parsing a vector
```{r}
str(parse_logical(c("TRUE", "FALSE", "NA")))
str(parse_integer(c("1", "2", "3")))
str(parse_date(c("2010-01-01", "1979-10-14")))

parse_integer(c("1", "231", ".", "456"), na = ".")

# Parsing failure
x <- parse_integer(c("123", "345", "abc", "123.45"))
x
problems(x)
```

# 11.3.1 Numbers
```{r}
parse_double("1.23")
parse_double("1,23", locale = locale(decimal_mark = ","))

# Ignore non-numeric characters before & after numbers
parse_number("$100")
parse_number("20%")
parse_number("It cost $123.45")

# Ignore grouping marks
parse_number("$123,456,789")
parse_number("123.456.789", locale = locale(grouping_mark = "."))
parse_number("123'456'789", locale = locale(grouping_mark = "'"))
# This DOESN'T work
parse_number("123, 456, 789", locale = locale(grouping_mark = ", "))
```

# 11.3.2 Strings
```{r}
charToRaw("Carson")
x1 <- "El Ni\xf1o was particularly bad this year."
x2 <- "\x82\xb1\x82\xf1\x82\xc9\x82\xbf\x82\xcd"
# Prints fine on my system, but may be gibberish elsewhere
x1
x2

parse_character(x1, locale = locale(encoding = "Latin1"))
parse_character(x2, locale = locale(encoding = "Shift-JIS"))

# When all else fails, try to guess
guess_encoding(charToRaw(x1))
guess_encoding(charToRaw(x2))
```

